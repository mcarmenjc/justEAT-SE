<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: views/app-view.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: views/app-view.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*global Backbone */

var app = app || {};

/** 
 * @class AppView
 * @augments Backbone.View
 * @requires Backbone.js
 * @requires underscore.js
 */
app.AppView = Backbone.View.extend(/** @lends AppView.prototype */{
    /** 
     * @property {Object} el Object that associates the view with the element in the DOM
     */
    el: '#main',
    /** 
     * @property {Object} events Object that associates different events in the DOM with the functions that handle them 
     */
    events: {
        'click #search': 'getRestaurants'
    },
    /** 
     * @contructs AppView object 
     * Set DOM properties values and add listener to changes in the collections
     * @param {Object} data
     */
    initialize: function (data) {
        var me = this;
        me.$restaurantList = me.$('#restaurant-list');
        me.$error = me.$('#error');
        me.$outcode = me.$('#outcode');
        me.Restaurants = new app.RestaurantCollection();
        me.listenTo(me.Restaurants, 'reset', me.addRestaurants);
        me.listenTo(me.Restaurants, 'fetchError', me.showServerError);
    },
    /** 
     * Fetch all restaurants depending on the outcode typed in the input text
     */
    getRestaurants: function() {
        var me = this,
            outcode = me.$outcode.val();
        me.$error.html('');
        if (outcode !== undefined &amp;&amp; outcode !== ''){
            me.Restaurants.fetch(outcode);
            me.$outcode.val('');
        }
        else {
            me.showNoOutcodeError();
        }
    },
    /** 
     * When app.Restaurants collection is reset, this method is called. For each restaurant in the collection
     * it will call the function addRestaurant
     */
    addRestaurants: function(){
        var me = this;
        me.$restaurantList.html('');
        me.Restaurants.each(me.addRestaurant, this);
    },
    /** 
     * Create a new app.RestaurantView for a restaurant and add it to the list.
     * @param {Object} restaurant Model object to display
     */
    addRestaurant: function(restaurant) {
        var view = new app.RestaurantView ({model: restaurant});
        this.$restaurantList.append(view.render().el);
    },
    /** 
     * Show no outcode error. Creates a new error and view for it, and append it to error div
     */
    showNoOutcodeError: function(){
        var error = new app.ErrorModel({message: 'Outcode can not be empty'}),
            view = new app.ErrorView ({model: error});
        this.$error.append(view.render().el);  
    },
    /** 
     * Show server error. Creates a new error and view for it, and append it to error div
     */
    showServerError: function(){
        var error = new app.ErrorModel({message: 'We are having problems, please try again later'}),
            view = new app.ErrorView ({model: error}),
            me = this;
        me.$restaurantList.html('');
        me.$error.append(view.render().el);  
    }
});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="AppView.html">AppView</a></li><li><a href="ErrorModel.html">ErrorModel</a></li><li><a href="ErrorView.html">ErrorView</a></li><li><a href="RestaurantCollection.html">RestaurantCollection</a></li><li><a href="RestaurantModel.html">RestaurantModel</a></li><li><a href="RestaurantView.html">RestaurantView</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Fri Jul 10 2015 08:55:11 GMT+0100 (BST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
