/*! justEAT-interview 10-07-2015 */
var app=app||{};app.ErrorModel=Backbone.Model.extend({defaults:function(){return{message:""}}});var app=app||{};app.RestaurantModel=Backbone.Model.extend({defaults:function(){return{Name:"",RatingStars:0,NumberOfRatings:0,CuisineTypes:void 0}}});var app=app||{};app.RestaurantCollection=Backbone.Collection.extend({model:app.RestaurantModel,url:"/restaurants",fetch:function(a){var b=this;$.ajax({url:"http://api-interview.just-eat.com/restaurants?q="+a,headers:{"Accept-Tenant":"uk","Accept-Language":"en-GB",Authorization:"Basic VGVjaFRlc3RBUEk6dXNlcjI="}}).done(function(a){b.reset(a.Restaurants)}).fail(function(a,c,d){b.trigger("fetchError",b)})}});var app=app||{};app.AppView=Backbone.View.extend({el:"#main",events:{"click #search":"getRestaurants"},initialize:function(a){var b=this;b.$restaurantList=b.$("#restaurant-list"),b.$error=b.$("#error"),b.$outcode=b.$("#outcode"),b.Restaurants=new app.RestaurantCollection,b.listenTo(b.Restaurants,"reset",b.addRestaurants),b.listenTo(b.Restaurants,"fetchError",b.showServerError)},getRestaurants:function(){var a=this,b=a.$outcode.val();a.$error.html(""),void 0!==b&&""!==b?(a.Restaurants.fetch(b),a.$outcode.val("")):a.showNoOutcodeError()},addRestaurants:function(){var a=this;a.$restaurantList.html(""),a.Restaurants.each(a.addRestaurant,this)},addRestaurant:function(a){var b=new app.RestaurantView({model:a});this.$restaurantList.append(b.render().el)},showNoOutcodeError:function(){var a=new app.ErrorModel({message:"Outcode can not be empty"}),b=new app.ErrorView({model:a});this.$error.append(b.render().el)},showServerError:function(){var a=new app.ErrorModel({message:"We are having problems, please try again later"}),b=new app.ErrorView({model:a}),c=this;c.$restaurantList.html(""),c.$error.append(b.render().el)}});var app=app||{};app.ErrorView=Backbone.View.extend({className:"mdl-cell mdl-cell--12-col mdl-cell--middle mdl-typography--text-center",initialize:function(){this.template=_.template($("#error-template").html())},render:function(){var a=this;return a.$el.html(a.template(a.model.toJSON())),a}});var app=app||{};app.RestaurantView=Backbone.View.extend({className:"mdl-cell mdl-cell--4-col",initialize:function(){this.template=_.template($("#restaurant-template").html())},render:function(){var a=this;return a.$el.html(a.template(a.model.toJSON())),a}});var app=app||{};$(function(){new app.AppView});